## java-mysql

1. 数据库实例：
   1. mysql属于关系型数据库
   2. 实例相当于连接数据库连接的一个种类
      * 本地实例 `localhost` ，远程的实例 `局域网，广域网`
   3. 每一个实例都有独立的账号、密码和连接字符串
   4. 实例在数据库中是一个独立的个体 `数据的一个对象`
   
   
### SQL语句
1. DDL `数据库定义语句`
   1. 创建数据库：`create database pro;` 数据库不能重名<br>
   任何一个关系型数据库，任何东西都是以表的形式存储<br>
   在数据库中有一张表来存储所有的数据库信息<br>
   
   char和varchar
   > varchar是可变→用于存储MD5加密过后的密码<br>
   char是不可变用于存储不加密的数据
   

2. DML `数据操作语句`


带有数据库的项目，至少封装两个类，用于操作数据库 `单立模式`
1. 带有数据库连接账号、密码等敏感信息的类
2. 增加、删除、修改、查询的工具类

代码封装的关键点：
1. 一个方法只干一件事
2. 最终执行具体操作的方法不能暴露（私有的）

Statement
* 通过conn对象进入数据库做相应的操作，并且的到数据库的游标
将数据库和游标放在resultset中

#### 查询优化
在满足需求的前提下，尽可能的少从 `列数` `行数` 数据库查询数据

#### 批处理
1. 一次处理多条数据
2. 将要处理的数据收集起来，一次性提交
   * 节省的是和服务器的通讯次数
   * 消耗的是数据库服务器带宽
   * 消耗的是数据库的内存，和增加的是数据库的执行计划
   
   执行计划
   * 数据库执行一条sql语句之前，都会在数据库上产生一个执行计划
   * 该计划用于计算一条sql数据执行的结果需要占用多少内存
3. 批处理一般情况下用于处理动态sql，批处理不能用select

* 批处理不是一起执行的
* 没有回滚操作
* 如果有sql语句报错，绕过该语句，继续执行下一条
* 需要批量导入数据但是同时对这些数据完整性不作要求
   1. 超市商品的录入
   2. 对数据完整性不负责的操作
   
* 批处理执行中如果sql语句出错，
* addBatch(将sql语句和序列化数据)只缓存在本地，不做提交
* 只会在executeBatch方法执行中报错，
* 操作的时候要时刻关注服务器的内存情况
* 增加、删除、修改可以使用批处理，select因为要返回一个查询结果集所以不能批处理

#### PreparedStatement
1. 为预定义版本的sql添加预定义参数
2. 将所有的操作先写入临时表，如果无误，再添加到主标中。

`PreparedStatement` `Statement`在一次请求中只能有一个对象

Statement PreparedStatement区别：
1. Statement不能使用动态sql，
   Statement用于做查询，使用时一次性创建需要的内存空间（操作一一次内存）
   
2. PreparedStatement 可以使用动态sql，有临时

#### 动态/静态sql `动态sql便于做优化`
区别
1. 静态sql：和程序一起便宜，附属在当前的程序上<br>
动态sql：在程序编译之前编译，并且将缓存结果发送到数据库

2. 静态sql：涉及到的数据库对象要提前创建好<br>
动态sql：涉及到的数据库对象可以提前创建，也可以运行的时候创建

3. 静态sql：如果改变执行对象，那么需要将程序包重新对sql语句做绑定<br>
动态sql：只需要重新编译执行过的部分 

4. 静态sql：对该语句做优化，不一定有效果<br>
动态sql：对该语句做优化，一定有效果


#### 事务
1. 保证多条sql语句中数据的唯一性
2. 数据库/程序事务
   1. 数据库的事务 `transaction`
      * 在数据库中执行，如果sql语句有错误，数据库会回滚该操作（回档）
      * 所造成的影响：对临时表有影响，对主表没有影响
   2. 程序中的事务
      * 是封装在Connection连接对象中的
      * 事务的提交和回滚由jdk监管，调用方法执行提交或者是回滚
      * 如果sql语句有错，直接在程序中回滚，不会对数据库造成任何影响
      * 自动提交setAutoCommit(true)
      * 手动提交setAutoCommit(false)
      如果想手动监管事务，setAutoCommit要写在
      
不要对查询操作创建事务

---

### 存储过程
一个方法（数据库），提供一个名称给程序调用<br>
可以一次执行多条带逻辑判断的sql语句

优点
1. 避免sql语句暴露在外面
2. 将部分数据处理的逻辑从程序中分离
3. 分辨sql语句的优化

缺点：
1. 笨重（数据迁移）
2. 多人同时执行时，消耗比较多的资源

1. 存储过程中每一行语句需要 `;`
2. 存储过程中调用call过程名称 `[(参数)]`
3. java中调用mysql存储过程使用 `CallableStatement`
4. java调用mysql的存储过程需要加`{}`
5. 如果存储过程没有参数可以省略 `()`

程序包

内存有两种结构
1. 堆 `值` `常量`
2. 栈 `引用` `静态`

四种内存存储空间
1. 值 
2. 引用
3. 常量
4. 静态